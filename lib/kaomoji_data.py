"""
Kaomoji Data Module
颜文字数据模块

Provides single-line and multiline kaomoji formats with mood categories.
提供单行和多行颜文字格式及情绪分类。

分类体系 (Category System)::

    正面 (Positive):  happy, euphoria, excitement, love, proud, relaxed
    负面 (Negative):  sad, angry, anxiety, fear, panic, disappointed, lonely
    中性 (Neutral):   neutral, confused, surprised, sleepy, thinking,
                      embarrassed, bored
    经典 (Classic):   bull (= happy 别名), bear (= sad 别名)
"""

# ========== 单行颜文字格式 ==========
# Single-line format: all faces are unique strings without newlines
# 每个分类 10-15 个不重复的颜文字

KAOMOJI_SINGLE = {
    # --------------------------------------------------
    # 正面情绪 (Positive Emotions)
    # --------------------------------------------------
    "happy": [
        "(^o^)",
        "(◠‿◠)",
        "(^_^)",
        "(◕‿◕)",
        "(＾▽＾)",
        "(⌒‿⌒)",
        "(´｡• ᵕ •｡`)",
        "(ᵔᴥᵔ)",
        "(•‿•)",
        "( ◜‿◝ )",
        "(ノ´ヮ`)ノ",
        "(✧ω✧)",
        "(｡◕‿◕｡)",
        "(*´▽`*)",
        "(◠ᴥ◠)",
    ],
    "euphoria": [
        "\\(^o^)/",
        "(≧▽≦)",
        "\\(≧∇≦)/",
        "ヽ(>∀<☆)ノ",
        "☆*:.｡.o(≧▽≦)o.｡.:*☆",
        "(ﾉ◕ヮ◕)ﾉ*:・ﾟ✧",
        "ヽ(♡‿♡)ノ",
        "ヾ(＠⌒ー⌒＠)ノ",
        "\\(★ω★)/",
        "(☆▽☆)",
        "ヽ(´▽`)/",
        "\\(^▽^)/",
        "(ノ≧∀≦)ノ",
        "ヾ(≧▽≦*)o",
        "(*≧▽≦)",
    ],
    "excitement": [
        "(*^_^*)",
        "(^_^)v",
        "(๑´ڡ`๑)",
        "ヾ(^▽^)ノ",
        "(ノ´ з `)ノ",
        "(o^▽^o)",
        "(*≧ω≦)",
        "(ﾉ>ω<)ﾉ",
        "⸜(｡˃ ᵕ ˂ )⸝♡",
        "ヽ(○´∀`)ﾉ♪",
        "♪(´▽｀)",
        "(^o^)♪",
        "ヾ(^∇^)",
        "(´∀`)♡",
        "٩(◕‿◕｡)۶",
    ],
    "love": [
        "(♡˙︶˙♡)",
        "(´,,•ω•,,)♡",
        "(◕‿◕)♡",
        "(♡ >ω< ♡)",
        "(⁄ ⁄•⁄ω⁄•⁄ ⁄)♡",
        "♡(◡‿◡)",
        "(´ ε ` )♡",
        "(๑°o°๑)♡",
        "(*♡∀♡)",
        "(◍•ᴗ•◍)❤",
        "♡＾▽＾♡",
        "(≧◡≦) ♡",
        "(灬♥ω♥灬)",
        "(♥ω♥*)",
        "(ɔˆ ³(ˆ⌣ˆc)",
    ],
    "proud": [
        "(•̀ᴗ•́)و",
        "(ง •̀_•́)ง",
        "(`・ω・´)",
        "(￣ー￣)ゞ",
        "(¬‿¬)",
        "(•̀ᴗ•́)و ̑̑",
        "( •̀ .̫ •́ )✧",
        "(ᵔˇᵔ)",
        "(•̀ᴗ•́)b",
        "( ˙▿˙ )σ",
        "(*•̀ᴗ•́*)و",
        "(ˆ‿ˆ)و",
        "(≖ᴗ≖✿)",
        "(⌐■_■)",
        "( ˘ω˘ )☞",
    ],
    "relaxed": [
        "(´ー`)",
        "(￣▽￣)",
        "( ˘ω˘ )",
        "(◡‿◡✿)",
        "(─‿‿─)",
        "( ˇ‿ˇ )",
        "(∪｡∪)｡｡｡zzZ",
        "(◡ ‿ ◡ ✿)",
        "( ´ ▽ ` )ﾉ",
        "(✿◠‿◠)",
        "(◠‿◠✿)",
        "(‐^▽^‐)",
        "( ˙꒳​˙ )",
        "(◕ᴗ◕✿)",
        "(*˘︶˘*).｡.:*♡",
    ],
    # --------------------------------------------------
    # 负面情绪 (Negative Emotions)
    # --------------------------------------------------
    "sad": [
        "(;_;)",
        "(T_T)",
        "(╥﹏╥)",
        "(ಥ_ಥ)",
        "(;ω;)",
        "(っ˘̩╭╮˘̩)っ",
        "(｡•́︿•̀｡)",
        "(ノД`)・゜・。",
        "(╯︵╰,)",
        "(´;︵;`)",
        "(⌯˃̶᷄ ﹏ ˂̶᷄⌯)",
        "(´°̥̥̥̥̥̥̥̥ω°̥̥̥̥̥̥̥̥`)",
        "(இ﹏இ`｡)",
        "(・ε・`)",
        "(｡ŏ﹏ŏ)",
    ],
    "angry": [
        "(╬ Ò﹏Ó)",
        "(ノಠ益ಠ)ノ",
        "(╬▔皿▔)╯",
        "(ﾉ`Д´)ﾉ",
        "(`皿´＃)",
        "(‡▼益▼)",
        "(╬ಠ益ಠ)",
        "( ` ω ´ )",
        "(・`ω´・)",
        "(＃`Д´)",
        "ヽ(`Д´)ノ",
        "(>_<メ)",
        "(-_-メ)",
        "(╬⓪益⓪)",
        "٩(╬ʘ益ʘ╬)۶",
    ],
    "anxiety": [
        "(´；ω；`)",
        "(°△°|||)",
        "(・_・;)",
        "(⊙_⊙;)",
        "(´・_・`)",
        "(；一_一)",
        "(°ー°〃)",
        "(；´∀｀)",
        "(^^;)",
        "(；′⌒`)",
        "(´Д`;)",
        "Σ(°△°|||)",
        "(´-ω-`)",
        "(⊙﹏⊙)",
        "(ーー;)",
    ],
    "fear": [
        "(>_<)",
        "Σ(°△°|||)︴",
        "(ʘᗩʘ')",
        "((((；゜Д゜)))",
        "(;°Д°)",
        "(º﹃º)",
        "Σ(っ°Д°;)っ",
        "(,,Ծ‸Ծ,,)",
        "(꒪⌓꒪)",
        "(°ロ°) !",
        "ヽ(°〇°)ﾉ",
        "(ノ°ο°)ノ",
        "(°▽°;)",
        "(꒪ȏ꒪;)",
        "∑(O_O；)",
    ],
    "panic": [
        "(x_x)",
        "(×_×;）",
        "(✖╭╮✖)",
        "(☉_☉)",
        "(゜゜;)",
        "Σ(ﾟДﾟ;≡;ﾟдﾟ)",
        "(ﾟ´Д`ﾟ);;;",
        "ヽ(ﾟДﾟ)ﾉ",
        "(=ﾟДﾟ=)",
        "w(°ｏ°)w",
        "Σ(°Д°υ)",
        "(゜ロ゜)",
        "(ﾟoﾟ;;",
        "(°◇°;)",
        "ヘ(°◇、°)ノ",
    ],
    "disappointed": [
        "(；￣Д￣)",
        "(＞﹏＜)",
        "(¯―¯٥)",
        "(=_=)",
        "(ー_ー)!!",
        "(´-ε-`)",
        "(-ω-、)",
        "(;´д`)",
        "(；−_−)",
        "(^_^;)",
        "(´Д`)",
        "(ー△ー;)",
        "(´ ・ω・`)",
        "(¬_¬ )",
        "┐(´д`)┌",
    ],
    "lonely": [
        "(ぼっち)",
        "(ノω・、)",
        "(´;ω;`)",
        "(ﾟ´ω`ﾟ)",
        "(._.)",
        "(◞‸◟)",
        "(´・ω・`)",
        "(∩︵∩)",
        "(ノ_<、)",
        "(μ_μ)",
        "(。-_-。)",
        "( ´ ;ω;)",
        "(ˊ̥̥̥̥̥ ³ ˋ̥̥̥̥̥)",
        "(•̩̩̩̩_•̩̩̩̩)",
        "(ᗒᗣᗕ)՞",
    ],
    # --------------------------------------------------
    # 中性 / 其他情绪 (Neutral / Other Emotions)
    # --------------------------------------------------
    "neutral": [
        "(._.) ",
        "(o.o)",
        "(-_-)",
        "(o_o)",
        "(・_・)",
        "(￣ ￣)",
        "(¬_¬)",
        "( ・ ・ )",
        "(• _ •)",
        "(  ˙-˙  )",
        "(-_-;)",
        "( ・_・)",
        "(−_−)",
        "(→_→)",
        "( ˙˙ )",
    ],
    "confused": [
        "(？_？)",
        "(⊙_⊙)",
        "(?_?)",
        "(•ิ_•ิ)?",
        "σ(ﾟ∀ﾟ )",
        "「(°ヘ°)",
        "(¬‿¬ )",
        "( ˘•ω•˘ ).oOஇ",
        "(・・?",
        "(ﾟヘﾟ)？",
        "(゜-゜)",
        "щ(゜ロ゜щ)",
        "(@ ̄Д ̄@;)",
        "( ⧉ ⦣ ⧉ )",
        "(?ω?)",
    ],
    "surprised": [
        "Σ(°△°|||)",
        "(ﾟoﾟ)",
        "(⊙ω⊙)",
        "Σ(ﾟДﾟ)",
        "(°o°；)",
        "(ﾟ∀ﾟ )",
        "(*゜ロ゜)",
        "(☉_☉)",
        "(ﾟдﾟ)",
        "(°ㅁ°)",
        "w(°o°)w",
        "(ㆆ_ㆆ)",
        "(*ﾟﾛﾟ)",
        "(°△°)",
        "( ꒪Д꒪)ノ",
    ],
    "sleepy": [
        "(=_=) zzZ",
        "(-.-)Zzz・・・",
        "(´〜`)ゞ",
        "(∪｡∪)｡｡｡zzZ",
        "(- ω -) zzZ",
        "(-_-) zzZ",
        "(σωσ)",
        "(ᴗ˳ᴗ)",
        "(≧ω≦) zzZ",
        "₍₍ ◟(∗ˊ꒵ˋ∗)◞ ₎₎",
        "(눈_눈)",
        "(¦3[▓▓]",
        "(-ε-)zzZ",
        "(。-ω-)zzZ",
        "(_ _).。o○",
    ],
    "thinking": [
        "(´-ω-`)",
        "( ˘_˘ )",
        "(¬‿¬)",
        "( ˇ‸ˇ )",
        "( ˘ ˘ )⸝",
        "(ㅎ_ㅎ)",
        "(　-_・)?",
        "(._.   )",
        "( ˙-˙ )",
        "(・ω・)ノ？",
        "(˘⌣˘)",
        "(・・)",
        "(◔_◔)",
        "(¯ ¯٥)",
        "( ⊙‿⊙)つ",
    ],
    "embarrassed": [
        "(⁄ ⁄>⁄ ▽ ⁄<⁄ ⁄)",
        "(*/ω＼*)",
        "(///ˊㅿˋ///)",
        "(〃▽〃)",
        "(*/▽＼*)",
        "(⁄ ⁄•⁄ω⁄•⁄ ⁄)",
        "(〃ω〃)",
        "(/ω\)",
        "(ᵕ≀ ̠ᵕ )",
        "(/ω\\)",
        "(⌒_⌒;)",
        "(ᵔ//ᵕ//ᵔ )",
        "(>ω<)",
        "(*ﾉ▽ﾉ)",
        "(o////o)",
    ],
    "bored": [
        "(￢_￢)",
        "( ´_ゝ`)",
        "(ノ_<。)",
        "(~_~;)",
        "(´∀`；)",
        "(  ´ _ゝ`)",
        "( ̄ ω ̄)",
        "(ﾟ_ﾟ)",
        "(¬_¬ )",
        "(  ¯ω¯)",
        "(∩_∩;)",
        "(-_-)旦~",
        "(ε(#)³)₃",
        "(o_△_)o",
        "( ˘_˘)╭",
    ],
    # --------------------------------------------------
    # 经典别名 (Classic Aliases) — 保持向后兼容
    # bull 和 bear 各自从对应正面/负面情绪中精选
    # --------------------------------------------------
    "bull": [
        "(^o^)",
        "(≧▽≦)",
        "\\(^o^)/",
        "(◠‿◠)",
        "(^_^)",
        "(◕‿◕)",
        "(*^_^*)",
        "(ﾉ◕ヮ◕)ﾉ*:・ﾟ✧",
        "(☆▽☆)",
        "ヽ(´▽`)/",
        "٩(◕‿◕｡)۶",
        "(⌒‿⌒)",
        "(✧ω✧)",
        "(ノ´ヮ`)ノ",
        "(＾▽＾)",
    ],
    "bear": [
        "(;_;)",
        "(x_x)",
        "(╥﹏╥)",
        "(T_T)",
        "(>_<)",
        "(ಥ_ಥ)",
        "(╬ Ò﹏Ó)",
        "(ノД`)・゜・。",
        "(;ω;)",
        "((((；゜Д゜)))",
        "(✖╭╮✖)",
        "(╯︵╰,)",
        "(ー_ー)!!",
        "(×_×;）",
        "(ʘᗩʘ')",
    ],
}

# ========== 多行颜文字格式（向后兼容）==========
# Multiline format: 3-line ASCII art, preserved for backward compatibility
# 新增分类也提供多行版本
KAOMOJI_MULTILINE = {
    "bull": [
        ["  ^___^  ", " (◠‿◠) ", "  \\___/  "],
        ["  *___*  ", " (^o^) ", "  <___>  "],
        ["  O___O  ", " (≧▽≦)", "  |___|  "],
        ["  \\o/   ", "   |    ", "  / \\   "],
        ["  ^_^   ", " <(^_^)>", "  (_)   "],
    ],
    "bear": [
        ["  T_T   ", " (;_;)  ", "  |_|   "],
        ["  -_-   ", " (x_x)  ", "  |_|   "],
        ["  >_<   ", " (╥﹏╥)", "  |_|   "],
    ],
    "neutral": [
        ["  -_-   ", " (._.)  ", "  |_|   "],
        ["  o_o   ", " (o.o)  ", "  |_|   "],
        ["  ._,   ", " (・_・)", "  |_|   "],
    ],
    "happy": [
        ["  ^___^  ", " (◠‿◠) ", "  \\___/  "],
        ["  *___*  ", " (^o^) ", "  <___>  "],
        ["  ◕___◕  ", " (◕‿◕) ", "  \\_v_/  "],
    ],
    "euphoria": [
        ["  \\o/   ", "   |    ", "  / \\   "],
        ["  ^_^   ", " <(^_^)>", "  (_)   "],
        [" ☆___☆  ", " (≧▽≦) ", "  *___*  "],
    ],
    "excitement": [
        ["  *___*  ", " (^o^) ", "  <___>  "],
        ["  O___O  ", " (≧▽≦)", "  |___|  "],
        ["  ^v^   ", " (*^_^*)", "  \\_/   "],
    ],
    "love": [
        [" ♡___♡  ", " (♡‿♡) ", "  \\_♡_/  "],
        ["  ♡ ♡   ", " (◕‿◕)♡", "  |_|   "],
        ["  ^___^  ", " (*♡∀♡)", "  ♡___♡  "],
    ],
    "proud": [
        ["  •̀_•́   ", " (•̀ᴗ•́)و", "  |_|   "],
        ["  ̄ー ̄   ", " (`・ω・´)", "  \\___/  "],
    ],
    "relaxed": [
        ["  ~___~  ", " (´ー`) ", "  |_|   "],
        [" ✿___✿  ", " (◡‿◡✿)", "  \\_/   "],
    ],
    "sad": [
        ["  T_T   ", " (;_;)  ", "  |_|   "],
        ["  >_<   ", " (╥﹏╥)", "  |_|   "],
        ["  ._,   ", " (ಥ_ಥ)  ", "  |_|   "],
    ],
    "angry": [
        ["  #___#  ", " (╬Ò﹏Ó)", "  |_|   "],
        ["  >___<  ", " (ﾉ`Д´)ﾉ", "  /_\\   "],
    ],
    "anxiety": [
        ["  o_o   ", " (o.o)  ", "  |_|   "],
        ["  -_-   ", " (._.)  ", "  |_|   "],
        ["  ;_;   ", " (´；ω；`)", "  |_|   "],
    ],
    "fear": [
        ["  >_<   ", " (╥﹏╥)", "  |_|   "],
        ["  T_T   ", " (;_;)  ", "  |_|   "],
        ["  !!!   ", " Σ(°△°)", "  |_|   "],
    ],
    "panic": [
        ["  -_-   ", " (x_x)  ", "  |_|   "],
        ["  >_<   ", " (╥﹏╥)", "  |_|   "],
        ["  X_X   ", " (✖╭╮✖)", "  |_|   "],
    ],
    "disappointed": [
        ["  =_=   ", " (=_=)  ", "  |_|   "],
        ["  -_-   ", " (ー_ー)", "  |_|   "],
    ],
    "lonely": [
        ["  ._.   ", " (._.） ", "  |_|   "],
        ["  ;_;   ", " (ノω・、)", "  |_|   "],
    ],
    "confused": [
        ["  ?_?   ", " (？_？)", "  |_|   "],
        ["  o_O   ", " (⊙_⊙) ", "  |_|   "],
    ],
    "surprised": [
        ["  !!!   ", " Σ(ﾟДﾟ)", "  |_|   "],
        ["  O_O   ", " (ﾟoﾟ)  ", "  |_|   "],
    ],
    "sleepy": [
        ["  z_z   ", " (=_=)  ", "  zzZ   "],
        ["  -_-   ", " (-.-)  ", "  zzZ   "],
    ],
    "thinking": [
        ["  -_-   ", " (˘_˘)  ", "  |_|   "],
        ["  ._,   ", " (◔_◔)  ", "  |_|   "],
    ],
    "embarrassed": [
        ["  //    ", " (〃▽〃)", "  |_|   "],
        ["  ///   ", " (*/ω＼*)", "  |_|   "],
    ],
    "bored": [
        ["  =_=   ", " (￢_￢) ", "  |_|   "],
        ["  -_-   ", " ( ´_ゝ`)", "  |_|   "],
    ],
}

# ========== 情绪分类映射 ==========
# Maps parent categories to all moods that belong to them.
# Used for: sentiment normalization, fallback resolution.
MOOD_CATEGORIES = {
    "bull": [
        "bull", "happy", "euphoria", "excitement",
        "love", "proud", "relaxed", "excited",
    ],
    "bear": [
        "bear", "sad", "angry", "fear", "panic",
        "disappointed", "lonely", "anxious",
    ],
    "neutral": [
        "neutral", "confused", "surprised", "sleepy",
        "thinking", "embarrassed", "bored",
        "calm", "uncertain", "anxiety",
    ],
}


def get_kaomoji(mood, format="single"):
    """
    获取颜文字 - Get kaomoji face(s) for a mood

    支持精确匹配优先：如果 mood 在数据中有直接 key 则返回该 key 的列表；
    否则 fallback 到父类（bull/bear/neutral）。

    参数 / Parameters:
        mood (str): 情绪类型 - Mood type (happy, love, sad, angry, neutral, ...)
        format (str): 格式 - Format ('single' or 'multiline')

    返回 / Returns:
        list: 颜文字列表 - List of kaomoji faces

    示例 / Example:
        >>> get_kaomoji('love', format='single')
        ['(♡˙︶˙♡)', '(´,,•ω•,,)♡', ...]

        >>> get_kaomoji('bull', format='multiline')
        [['  ^___^  ', ' (◠‿◠) ', '  \\___/  '], ...]
    """
    source = KAOMOJI_SINGLE if format == "single" else KAOMOJI_MULTILINE

    if format not in ("single", "multiline"):
        raise ValueError(f"Invalid format: {format}. Use 'single' or 'multiline'")

    # 精确匹配优先
    mood_lower = str(mood).lower()
    if mood_lower in source:
        return source[mood_lower]

    # Fallback: 找到父类
    parent = _resolve_parent(mood_lower)
    return source.get(parent, source.get("neutral", []))


def _resolve_parent(mood):
    """
    将情绪名解析到父类 (bull/bear/neutral)

    参数 / Parameters:
        mood (str): 情绪名称

    返回 / Returns:
        str: 父类名称
    """
    mood_lower = str(mood).lower()
    for category, members in MOOD_CATEGORIES.items():
        if mood_lower in members:
            return category
    return "neutral"


def convert_multiline_to_single(multiline_faces):
    """
    将多行颜文字转换为单行 - Convert multiline kaomoji to single-line

    参数 / Parameters:
        multiline_faces (list): 多行颜文字列表 - List of 3-line kaomoji

    返回 / Returns:
        list: 单行颜文字列表 - List of single-line kaomoji

    示例 / Example:
        >>> convert_multiline_to_single([["  ^___^  ", " (◠‿◠) ", "  \\___/  "]])
        ['(◠‿◠)']
    """
    single_faces = []
    for face in multiline_faces:
        if isinstance(face, list) and len(face) >= 3:
            # Extract middle line (the actual face)
            middle_line = face[1].strip()
            if middle_line:
                single_faces.append(middle_line)
    return single_faces


def migrate_kaomoji_format():
    """
    迁移颜文字格式 - Migrate from multiline to single-line format

    返回 / Returns:
        dict: 转换后的单行颜文字字典 - Converted single-line kaomoji dict

    说明 / Note:
        This function demonstrates how to convert existing multiline data
        to single-line format. Useful for gradual migration.
    """
    migrated = {}
    for mood, faces in KAOMOJI_MULTILINE.items():
        migrated[mood] = convert_multiline_to_single(faces)
    return migrated
